<xmodel version="2" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
     xsi:noNamespaceSchemaLocation='http://flame.ac.uk/schema/xmml_v2.xsd'>

<name>FreePotts 2D 4Points</name>
<version>01</version>
<description></description>

<environment>
    <functionFiles>
        <file>functions.c</file>
    </functionFiles>
    <dataTypes>
	<!-- List of user defined data types -->
	
	<!-- Datatype position which describes a position in 3D -->
	<dataType>
		<name>point</name>
		<description>position in 3D using doubles</description>
		<variables>
			<variable>
				<type>double</type>
				<name>x</name>
				<description>position on x-axis</description>
			</variable>
			<variable>
				<type>double</type>
				<name>y</name>
				<description>position on y-axis</description>
			</variable>
			<variable>
				<type>double</type>
				<name>z</name>
				<description>position on z-axis</description>
			</variable>
		</variables>
	</dataType>

	<!-- Datatype line which is defined by two positions in 3D -->
	<dataType>
		<name>fourpoints</name>
		<description>a cell defined by four points</description>
		<variables>
			<variable>
				<type>point</type>
				<name>p0</name>
				<description>Point 0</description>
			</variable>
			<variable>
				<type>point</type>
				<name>p1</name>
				<description>Point 1</description>
			</variable>
			<variable>
				<type>point</type>
				<name>p2</name>
				<description>Point 2</description>
			</variable>
			<variable>
				<type>point</type>
				<name>p3</name>
				<description>Point 3</description>
			</variable>
		</variables>
	</dataType>

    </dataTypes>
</environment>

<agents>

    <xagent>
    
        <name>cell2d4</name>
        <description></description>
        
        <memory>
            <variable><type>int</type><name>id</name><description></description></variable>
            <variable><type>fourpoints</type><name>points</name><description>4 points (p1,p2,p3,p4) with x,y,z. points.p1.x</description></variable>
            <variable><type>int</type><name>type</name><description></description></variable>
            <variable><type>double</type><name>middle[2]</name><description></description></variable>
        </memory>

        <functions>

            <function><name>outputcellposition</name>
                <description></description>
                <currentState>start</currentState>
                <nextState>1</nextState>
                <outputs>
                    <output><messageName>cellposition</messageName></output>
                </outputs>
            </function>

            <function><name>movecells</name>
                <description></description>
                <currentState>1</currentState>
                <nextState>2</nextState>
                <inputs>
                    <input>
                        <messageName>cellposition</messageName>
                        <filter>
                            <lhs><value>a.id</value></lhs>
                            <op>NEQ</op>
                            <rhs><value>m.id</value></rhs>
                        </filter>
                    </input>
                </inputs>
            </function>
	    
        </functions>
    </xagent>

</agents>

<messages>
    <message>
        <name>cellposition</name>
        <description></description>
        <variables>
            <variable><type>int</type><name>id</name><description></description></variable>
            <variable><type>fourpoints</type><name>points</name><description></description></variable>
            <variable><type>int</type><name>type</name><description></description></variable>
        </variables>
    </message>
</messages>

</xmodel>
